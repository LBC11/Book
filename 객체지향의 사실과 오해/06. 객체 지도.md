# 06. 객체 지도

그 동안은 객체지향을 역할과 책임을 수행하며 협력하는 자율적인 객체들의 공동체로 정의했다. 이번 장에서는 기능이 아니라 **구조를 바탕으로 시스템을 분할하는** 객체지향의 또 다른 측면에서 살펴볼 것이다.

## 1. 기능 설계 대 구조 설계

**기능(function) 측면의 설계**

- 제품이 사용자를 위해 **무엇을** 할 수 있는가
- 훌륭한 소프트웨어의 **충분 조건**
- 변경이 자주 일어나는 부분으로 **불안정**하다.
- **객체의 구현**에 해당하는 **내부**이다.
- 기능 기술을 위해 **유스케이스** 라는 기법을 사용한다.

**구조(structure) 측면의 설계**

- 제품의 **형태가 어떠해야** 하는가
- 훌륭한 소프트웨어의 **필요 조건**
- 변경이 거의 일어나지 않는 부분으로 **안정적**이다.
- **객체의 인터페이스**에 해당하는 **외부**이다.
- 안정적인 구조를 개념화하기 위해 **도메인 모델**을 사용한다.

- **충분조건:** 전제가 충족되면 반례(예외) 없이 결론이 성립할 때를 가리킨다.
- **필요조건:** 조건이 참이면 그 결론은 참일 수도 거짓일 수도 있지만, 이 조건을 충족시키지 못하면 그 결론은 반드시 거짓이 된다.

## 2. 유스케이스

사용자의 목표를 달성하기 위해 사용자와 시스템 간에 이뤄지는 상호작용의 흐름을 텍스트로 정리한 것이다.

**중요한 특성**

1. 유스케이스는 다이어그램이 아니라 사용자와 시스템간의 상호작용을 보여주는 **‘텍스트’** 이다.
2. 유스케이스는 하나의 시나리오가 아니라 **여러 시나리오들의 집합**이다. 하나의 시나리오는 유스케이스 인스턴스(use case instance)라고 한다.
3. 유스케이스는 단순한 피쳐(feature) 목록과 다르다.
    1. Feature: 기능의 목록을 단순하게 나열하여 서로 연관이 없는 독립적으로 보인다.
    2. 유스케이스: 이야기라는 문맥을 통해 연관된 기능들을 함께 묶을 수 있다.
4. 유스케이스는 자주 변경되는 사용자 인터페이스를 배제하여 **본질적인 유스케이스(essential use case)** 형식을 유지해야 한다.
5. 유스케이스는 **내부 설계와 정보를 포함하지 않는다**.
    1. 사실 유스케이스는 객체지향과 전혀 상관없다. 그래서 다른 패러다임에서도 사용 가능하다.
    2. 유스케이스를 통해 객체의 구조(domain model)를 쉡게 추출할 수 있다는 허황된 말을 믿지 말아라.

## 3. 도메인 모델

- **도메인(domain)**: 사용자가 프로그램을 사용하는 대상 분야
- **모델(model)**: 대상을 목적에 따라 추상화하고 단순화하여 표현한 것
- **도메인 모델(domain model)**
    - 사용자가 프로그램을 사용하는 대상 영역에 관한 지식을 선택적으로 단순화하고 의식적으로 구조화한 형태 - **사용자 모델**
    - 소프트웨어가 목적하는 영역 내의 개념과 개념 간의 관계, 다양한 규칙이나 제약 등을 주의 깊게 추상화 한 것 - **시스템 이미지**
    - 소프트웨어 개발과 관련된 이해 관계자들이 도메인에 대해 생각하는 관점 - **디자인 모델**
    - 사용자와 설계자는 직접적으로 상호작용 할 수 없으므로 설계자는 **디자인 모델을 기반으로 만든 시스템 이미지가 사용자 모델을 정확하게 반영**하도록 노력해야 한다.

**연결 완전성 = 표현적 차이 최소화**

- 도메인에 대한 사용자 모델, 디자인 모델, 시스템 이미지 모두 유사하게 만드는 객체지향의 특성
- 소프트웨어 객체와 현실 객체 사이의 의미적 거리 줄이는 것

**불안정한 기능을 담는 안정적인 도메인 모델**

- 도메인 모델의 핵심은 사용자의 관점을 반영하는 것이다.
- 사용자들이 누구보다 도메인의 ‘본질적인’ 측면을 가장 잘 이해하고 있다.
- 본질적이라는 것은 변경이 적고 그 특성이 오래 지속된다는 뜻이다. → 안정적인 구조 제공
- 우리는 소프트웨어를 창조할 때 도메인 모델을 은유함으로서 의미적 거리를 최대한 줄여야 한다.

→ 설계자가 도메인에 대한 사용자의 관점을 반영하기 위해서 도메인 모델을 은유함으로서 표현적 차이를 줄여야 한다. 그래야 변경에 유연하게 대응할 수 있는 탄력적인 소프트웨어를 만들 수 있다.

## 4. 재료 합치기: 기능과 구조의 통합

1. 사용자가 요구사항들을 식별하여 **유스케이스 작성**
2. 유스케이스에 명시된 **시스템의 기능을 시스템의 책임으로 전환** <- 책임-주도 설계 적용 시작
3. 시스템의 책임을 작은 규모의 객체들이 수행해야 하는 **더 작은 책임으로 세분화** 한다.
4. **도메인 모델에 따라 책임에 알맞은 객체를 선택**
5. 책임에 따라 **메시지를 식별**하고 각각의 **interface결정**
6. 3, 4, 5 의 과정을 반복적으로 시행하며 **협력을 완성**한다.
7. 마지막으로 객체를 구현하기 위헤 **클래스를 추가하고 속성과 함께 method를 추가**하여 **시스템의 기능을 완성**한다.

**유스케이스, 도메인 모델, 책임-주도 설계 역할**

- **유스케이스**: 기능 → 시스템의 책임으로 전환하여 **출발점(목표)** 제공
- **도메인 모델**: 불안정한 기능을 수용하기 위해 **안정적인 구조** 제공
- **책임-주도 설계**: 유스케이스로부터 목표를, 도메인 모델로부터 안정적인 구조를 제공받아 실제로 동작하는 객체들의 **협력 공동체 창조**

- 객체지향의 가장 큰 장점은 도메인을 모델링 하는 기법과 도메인을 프로그래밍 하기 위해 사용하는 기법이 같다는 것이다.
- 또한 도메인 모델링에서 사용한 객체와 개념을 부드럽게 프로그래밍 설계에서의 객체와 클래스로 변환할 수 있다. → **연결 완전성**
- 추가로 객체지향에서 연결완정성의 역방향 역시 성립한다. → **가역성**
